<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>MediBuddy AI - Symptom Checker</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="light-mode">

<!-- Theme Toggle Button -->
<div class="theme-toggle text-end p-3">
  <button id="theme-toggle-btn" onclick="toggleTheme()">ðŸŒ™ Dark Mode</button>
</div>

<!-- Symptom Suggestion List -->
<datalist id="symptomList"></datalist>

<div class="container py-5">
  <div class="card shadow-lg p-4">
    <h2 class="text-center mb-4 text-primary">ðŸ¤– MediBuddy AI - Illness Predictor</h2>

    <form method="POST" action="/result">
      <div id="symptom-container">
        <input type="text" name="symptoms" placeholder="Enter symptom (e.g., cough)" list="symptomList" class="form-control my-2 symptom-input" required>
        <label>Severity (1-5): <span class="severity-value">1</span></label>
        <input type="range" name="severity" min="1" max="5" value="1" class="form-range" oninput="this.previousElementSibling.querySelector('.severity-value').textContent = this.value">

      </div>

      <div class="d-grid mb-3">
        <button type="button" onclick="addSymptomField()" class="btn btn-outline-secondary">
          âž• Add Another Symptom
        </button>
      </div>

      <div class="d-grid">
        <button type="submit" class="btn btn-success">Get Illness & Medicine</button>
      </div>
    </form>
  </div>
</div>
 

<!-- Auto-suggestion and dynamic field script -->
<script>
  const symptomSuggestions = [
    "fever", "cough", "cold", "headache", "sore throat", "fatigue", "body pain", "vomiting", "nausea",
    "diarrhea", "dizziness", "rash", "chest pain", "shortness of breath", "sneezing", "runny nose",
    "eye irritation", "joint pain", "back pain", "ear pain"
  ];

  const datalist = document.getElementById("symptomList");
  symptomSuggestions.forEach(symptom => {
    const option = document.createElement("option");
    option.value = symptom;
    datalist.appendChild(option);
  });

function addSymptomField() {
    const container = document.getElementById("symptom-container");

    const group = document.createElement("div");
    group.className = "symptom-group mb-3";

    const input = document.createElement("input");
    input.type = "text";
    input.name = "symptoms";
    input.placeholder = "Enter symptom (e.g., fever)";
    input.className = "form-control mb-2";
    input.setAttribute("list", "symptomList");

    const label = document.createElement("label");
    label.innerHTML = 'Severity (1-5): <span class="severity-value">1</span>';

    const slider = document.createElement("input");
    slider.type = "range";
    slider.name = "severity";
    slider.min = "1";
    slider.max = "5";
    slider.value = "1";
    slider.className = "form-range";
    slider.oninput = function () {
        label.querySelector('.severity-value').textContent = this.value;
    };

    group.appendChild(input);
    group.appendChild(label);
    group.appendChild(slider);

    container.appendChild(group);
}

  function toggleTheme() {
    const body = document.body;
    const btn = document.getElementById("theme-toggle-btn");

    if (body.classList.contains("dark-mode")) {
      body.classList.remove("dark-mode");
      body.classList.add("light-mode");
      btn.innerHTML = "ðŸŒ™ Dark Mode";
    } else {
      body.classList.remove("light-mode");
      body.classList.add("dark-mode");
      btn.innerHTML = "â˜€ï¸ Light Mode";
    }
  }

  window.onload = () => {
    document.body.classList.add("light-mode");
  };
 
function toggleChatbot() {
    const box = document.getElementById("chatbot-box");
    box.style.display = (box.style.display === "none") ? "block" : "none";
}

function sendChat() {
    const input = document.getElementById("chatbot-input");
    const messages = document.getElementById("chatbot-messages");

    const userText = input.value.trim();
    if (!userText) return;

    // Show user message
    const userDiv = document.createElement("div");
    userDiv.innerHTML = "<b>You:</b> " + userText;
    messages.appendChild(userDiv);

    // Simple logic for medicine response
    const responseDiv = document.createElement("div");
    let response = "Sorry, I couldn't understand.";

    if (userText.includes("cold") || userText.includes("cough")) {
        response = "You may have a common cold. Try taking Cetirizine or Dolo 650.";
    } else if (userText.includes("fever")) {
        response = "Possible fever. Try Paracetamol 500mg and stay hydrated.";
    } else if (userText.includes("headache")) {
        response = "Take a pain reliever like Crocin or Dolo.";
    } else if (userText.includes("throat")) {
        response = "Sore throat? Use lozenges and warm saltwater gargles.";
    }

    responseDiv.innerHTML = "<b>Bot:</b> " + response;
    messages.appendChild(responseDiv);

    input.value = "";
    messages.scrollTop = messages.scrollHeight;
}

</script>

<!-- Chatbot Floating Button -->
 <button class="chatbot-btn" onclick="toggleChatbot()">ðŸ’¬</button>

 <!-- Chatbot Box -->

<div class="chatbot-box" id="chatbot-box" style="display: none;">
  <div class="chatbot-header">MediBudyy Chatbot <span on click="toggleChatbot()" style="float:right; cursor:pointer;">âœ–</span></div>
  <div class="chatbot-message" id="chatbot-message"></div>
  <input type="text" id="chatbot-input" placeholder="Type Your symptom..." onkeydown="if(event.key==='Enter')sendChat()">
</div>
<div class="text-center mt-4">
  <a href="/chatbot" target="_blank" class="btn btn-primary">ðŸ’¬ Open Chatbot</a>
</div>

</body>
</html>
